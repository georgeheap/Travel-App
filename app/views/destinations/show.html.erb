<div class="main">
  <h1 class="dest_show">Welcome to <%= @destination.name %>!</h1>
  <div class="col-md-4">
    <div class="sidebar">
      <div id="gallery">
        <div id="panel">
          <%= image_tag("#{@destination.default_img}", alt:"#{@destination.name}", class: "large_img", id: "largeImage") %>
        </div>
        <div id="thumbs">
          <%= image_tag("#{@destination.default_img}", alt:"#{@destination.name}", class: "extra_img") %>
          <% if !@destination.img1.blank? %>
            <%= image_tag("#{@destination.img1}", alt:"#{@destination.name}", class: "extra_img") %>
          <% end %>
          <% if !@destination.img2.blank? %>
            <%= image_tag("#{@destination.img2}", alt:"#{@destination.name}", class: "extra_img") %>
          <% end %>
        </div>
      </div>

      <p>
        <%= @destination.description %>
      </p>
      <%= link_to 'Back', destinations_path %>
    </div>
  </div>
  <div class="col-md-8 map">
    <div id="map"></div>
  </div>
  <h3>Featured Tours</h3>
  <div class="tours_list">
    <% @tours.each do |tour| %>
    <%= image_tag tour.default_img, class: "extra_img" %>
      <%= tour.name %> <br/>
      <%= tour.description %> <br/>
      <%#= link_to 'Show', user_tour_path(current_user.id, trip) %><br/>
      <hr>
    <% end %>
  </div>
  <script>
    var path = window.location.pathname;
    $('#thumbs img').click(function(){
      $('#largeImage').attr('src',$(this).attr('src').replace('thumb','large'));
      $('#description').html($(this).attr('alt'));
    });
    function initMap() {
      mapDiv = $('#map');
      var lat = '<%=@destination.lat%>';
      var lng = '<%=@destination.lng%>';

      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 9,
        center: new google.maps.LatLng(lat,lng),
      });

      var locMarker = new google.maps.Marker({
        position: new google.maps.LatLng(lat,lng),
        map: map
      });
      tourMarker(map);



    }
    function tourMarker(map) {
      $.get(path + '.json', function (results) {
        for (var i = 0; i < results.tours.length; i++) {
          var tour = results.tours[i];
          var latLng = new google.maps.LatLng(tour.lat,tour.lng);
          var marker = new google.maps.Marker({
            position: latLng,
            map: map
          });
        }
      });
    }
  </script>
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?v=3.25&key=AIzaSyBv5nUaJwXmq6HLHClQsQdeeDGS7b1SZ24&callback=initMap">
  </script>
</div>
<div class="push"></div>
